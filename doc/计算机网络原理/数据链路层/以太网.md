# 数据链路层基本概念

![computer-26.png](/doc/imgs/computer/computer-26.png)

## 1. 数据链路层使用的信道类型

**数据链路层使用的信道主要有以下两种类型：**
* 点对点信道：这种信道使用一对一的点对点通信方式
* 广播信道：这种信道使用一对多的广播通信方式，一次你过程比较复杂。广播信道上连接的主机很多，因此必须使用专用的共享信道协议来
协调这些主机的数据发送。

## 2、链路和数据链路

**链路（link）**：是一条点到点的物理线段路段，中间没有任何其他的交换结点。【一条链路只是一条通路的一个组成部分】

**数据链路（data link）**：处理物理线路外，还必须有通信协议来控制这些数据的传输。若把实现这些协议的硬件和软件加到链路上，就构成了数据链路。
* 现最常用的方法是使用适配器（即：网卡）来实现这些协议的硬件和软件。
* 一般的适配器都包括了数据链路层和物理层这两层功能。

## 3、帧

**帧**：数据链路层传送的是帧。

数据包添加一个头和一个尾以及校验值，就会形成数据帧。


![computer-27.png](/doc/imgs/computer/computer-27.png)

点对点信道的数据链路层在进行通信时的主要步骤：
* 结点A的数据链路层把网络层交下来的 IP 数据报添加首部和尾部封装成帧。
* 结点A把封装好的帧发送给结点B的数据链路层
* 若结点B的数据链路层收到的帧无差错，则从收到的帧中提取出 IP 数据报上交给上面的网络层；否则丢弃这个帧。


常常在两个对等的数据链路层之间画出一个数字管道，而在这条数字管道上传输的数据单位是帧。

## 4、数据链路层的三个基本问题

### 4.1 封装成帧

封装成帧（framing）就是在一段数据的前后分别添加首部和尾部，然后构成一个帧。确定帧的界限。
* 首部和尾部的一个重要作用就是进行帧定界。

![computer-28.png](/doc/imgs/computer/computer-28.png)

用控制字符进行帧定界的方法：

![computer-32.png](/doc/imgs/computer/computer-32.png)

* SOH 和 EOT 都是控制字符的名称。
* SOH的十六进制编码为 01，二进制编码为 00000001
* EOT的十六进制编码为 04，二进制编码为 00000100

### 4.2 透明传输

透明传输的问题：

![computer-29.png](/doc/imgs/computer/computer-29.png)

用**字节填充法**解决透明传输的问题：

发送端的数据链路层在数据中出现控制字符 “SOH” 或 “EOT”的前面插入一个转义字符 “ESC”（其十六进制编码是 1B）

字节填充（byte stuffing）或字符填充（character stuffing）：接收端的数据链路层在讲数据送往网络层之前删除插入的转义字符。

如果转义字符也出现在数据中，那么应在转义字符前插入一个转义字符。当接收端收到连续两个转义字符时，就删除其中前面那的那一个。

![computer-30.png](/doc/imgs/computer/computer-30.png)

### 4.3 差错控制

比特差错：在传输过程中可能会产生 **比特差错**：1 可能会变成0，而 0 也可能会变成1。

误码率（BER - Bit Error Rate）：在一段时间内，传输错误的比特占所传输比特总数的比率称为 **误码率**

误码率与信噪比有很大的关系。

为了保证数据传输的可靠性，在计算机网络传输数据时，必须采用各种差错检测措施。

注意：数据链路层只负责无差错接收，而可靠传输是由传输层去实现的。

------


**循环冗余检验（CRC）**

**帧检验序列FCS**：在数据后面添加上的冗余码称为帧检验序列 FCS（Frame Check Sequence）。

循环冗余检验 CRC 和帧检验序列 FCS 并不等同。
* CRC 是一种常用的检错方法，而FCS是添加在数据后面的冗余码
* FCS可以用CRC这种方法得出，但CRC并非用来获得FCS的唯一方法

接收端对收到的每一帧进行CRC检验：
* 若得出的余数 R = 0，则判定这个帧没有差错，就接受（accept）
* 若余数 R 不等于 0，则判定这个帧有差错，就丢弃。

特点：
* 这种检测方法并不能确定究竟是哪一个或哪几个比特出现了差错。
* 只要经过严格的筛选，并使用位数足够多的除数P，那么出现检测不到的差错的概率就很小很小。

![computer-31.png](/doc/imgs/computer/computer-31.png)








